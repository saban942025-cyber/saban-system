// --- NAVIGATION CONTROLLER ---
        window.navTo = (section) => {
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            event.currentTarget.classList.add('active');

            const frame = document.getElementById('app-frame');
            
            if (section === 'map') {
                // טעינת מודול המפה
                frame.src = "Dashboard.html?embed=true";
            } 
            else if (section === 'settings') {
                // טעינת מודול הגדרות (אם קיים)
                frame.src = "setup.html"; 
            }
            else {
                // חזרה לחמ"ל ושינוי טאב פנימי
                // בדיקה אם החמ"ל כבר טעון כדי למנוע טעינה מחדש
                if (frame.contentWindow.location.pathname.includes('whatsapp-center2.html')) {
                    frame.contentWindow.postMessage({ action: 'switchTab', tab: section }, '*');
                } else {
                    frame.src = "whatsapp-center2.html?embed=true";
                    // נחכה שהטעינה תסתיים ואז נחליף טאב
                    frame.onload = () => {
                        frame.contentWindow.postMessage({ action: 'switchTab', tab: section }, '*');
                    };
                }
            }
        };
