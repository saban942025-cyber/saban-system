<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Saban Brain OS ğŸ’</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Windows 11 Style Base */
        body { 
            background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%); 
            color: #334155; 
            font-family: 'Segoe UI', system-ui, sans-serif; 
            height: 100vh; 
            display: flex; 
            flex-direction: column; 
            overflow: hidden; 
        }
        
        /* Glassmorphism Panels */
        .glass-panel {
            background: rgba(255, 255, 255, 0.75);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
        }

        /* Layout Grid */
        .studio-layout { display: grid; grid-template-columns: 280px 1fr 340px; height: 100%; overflow: hidden; gap: 15px; padding: 15px; }
        
        /* Mobile Layout */
        @media (max-width: 1024px) {
            .studio-layout { display: block; padding: 0; }
            .panel-col { display: none; height: calc(100vh - 120px); } /* ××•×¡×ª×¨ ×›×‘×¨×™×¨×ª ××—×“×œ ×‘××•×‘×™×™×œ */
            .panel-col.active { display: block; animation: fadeIn 0.3s; }
            .mobile-nav { display: flex; }
        }
        @media (min-width: 1024px) {
            .mobile-nav { display: none; }
            .panel-col { display: block !important; height: 100%; border-radius: 16px; overflow: hidden; }
        }

        /* Sidebar Items */
        .brain-item { padding: 12px 16px; border-bottom: 1px solid rgba(0,0,0,0.05); cursor: pointer; transition: 0.2s; border-left: 3px solid transparent; }
        .brain-item:hover { background: rgba(255,255,255,0.8); }
        .brain-item.active { background: white; border-left-color: #0ea5e9; box-shadow: 0 2px 5px rgba(0,0,0,0.05); font-weight: 600; color: #0284c7; }

        /* Toolbar */
        .toolbar { 
            background: white; border-radius: 12px; padding: 10px; margin-bottom: 15px; 
            display: flex; gap: 8px; flex-wrap: wrap; border: 1px solid #e2e8f0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.03);
        }
        .tool-btn { 
            background: #f8fafc; border: 1px solid #e2e8f0; color: #475569; 
            padding: 8px 12px; border-radius: 8px; cursor: pointer; font-size: 13px; 
            display: flex; align-items: center; gap: 6px; transition: all 0.2s;
            font-weight: 500;
        }
        .tool-btn:hover { background: #e0f2fe; color: #0284c7; border-color: #bae6fd; transform: translateY(-1px); }
        
        /* Simulator */
        .phone-mockup { 
            background: white; border-radius: 35px; border: 8px solid #334155; 
            height: 100%; width: 100%; max-width: 320px; margin: 0 auto;
            overflow: hidden; display: flex; flex-direction: column; 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        .sim-screen { background: #f1f5f9; flex: 1; padding: 12px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }

        /* Bubbles */
        .bubble { padding: 10px 14px; border-radius: 16px; font-size: 14px; max-width: 85%; width: fit-content; line-height: 1.5; animation: slideUp 0.3s ease-out; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .bubble-bot { background: white; border-top-right-radius: 4px; color: #1e293b; }
        .bubble-user { background: #0ea5e9; border-top-left-radius: 4px; color: white; align-self: flex-end; }
        
        /* Product Card Injection */
        .in-chat-product { background: white; padding: 10px; border-radius: 12px; margin-top: 5px; border: 1px solid #e2e8f0; display: flex; gap: 10px; align-items: center; }
        .in-chat-product img { width: 40px; height: 40px; object-fit: contain; }
        
        /* Typing Effect */
        .typing { display: flex; gap: 4px; padding: 12px; background: white; width: fit-content; border-radius: 16px; border-top-right-radius: 4px; margin-bottom: 5px; display: none; }
        .dot { width: 6px; height: 6px; background: #cbd5e1; border-radius: 50%; animation: bounce 1.4s infinite ease-in-out; }
        .dot:nth-child(1) { animation-delay: -0.32s; }
        .dot:nth-child(2) { animation-delay: -0.16s; }

        /* Product Search Dropdown */
        .product-search-results {
            position: absolute; top: 100%; left: 0; right: 0; background: white; 
            border: 1px solid #e2e8f0; border-radius: 8px; z-index: 50; 
            max-height: 200px; overflow-y: auto; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
            display: none;
        }
        .search-item { padding: 10px; border-bottom: 1px solid #f1f5f9; cursor: pointer; display: flex; align-items: center; gap: 10px; }
        .search-item:hover { background: #f8fafc; }

        /* Animations */
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
    </style>
</head>
<body>

    <header class="glass-panel h-16 flex items-center justify-between px-6 z-20 sticky top-0">
        <div class="flex items-center gap-3">
            <div class="w-9 h-9 bg-gradient-to-br from-blue-500 to-cyan-400 rounded-lg flex items-center justify-center text-white text-lg shadow-lg">ğŸ§ </div>
            <div>
                <h1 class="font-bold text-slate-700 tracking-tight">Saban Brain OS</h1>
                <div class="text-[10px] text-slate-400 font-medium">Windows Edition v3.0</div>
            </div>
        </div>
        <div>
            <button onclick="saveChanges()" class="bg-blue-600 hover:bg-blue-500 text-white px-5 py-2 rounded-lg font-bold transition shadow-lg shadow-blue-500/30 flex items-center gap-2">
                <i class="fas fa-save"></i> ×©××•×¨ ×©×™× ×•×™×™×
            </button>
        </div>
    </header>

    <div class="mobile-nav bg-white border-b flex justify-around p-2 lg:hidden sticky top-16 z-10">
        <button onclick="setTab('list')" class="text-slate-500 active-tab font-bold text-sm px-4 py-2 rounded-lg bg-slate-100" id="btn-list"><i class="fas fa-list"></i> × ×•×©××™×</button>
        <button onclick="setTab('editor')" class="text-slate-500 font-bold text-sm px-4 py-2 rounded-lg" id="btn-editor"><i class="fas fa-edit"></i> ×¢×•×¨×š</button>
        <button onclick="setTab('sim')" class="text-slate-500 font-bold text-sm px-4 py-2 rounded-lg" id="btn-sim"><i class="fas fa-mobile-alt"></i> ×˜×œ×¤×•×Ÿ</button>
    </div>

    <div class="studio-layout">
        
        <div id="col-list" class="panel-col glass-panel active flex flex-col">
            <div class="p-4 border-b border-gray-100 flex justify-between items-center bg-white/50">
                <span class="font-bold text-slate-600">ğŸ—‚ï¸ ×”××•×— ×©×œ×™</span>
                <button onclick="createNewTopic()" class="text-xs bg-blue-50 text-blue-600 px-3 py-1.5 rounded-full font-bold hover:bg-blue-100">+ ×—×“×©</button>
            </div>
            <div id="topicsContainer" class="flex-1 overflow-y-auto custom-scroll">
                </div>
        </div>

        <div id="col-editor" class="panel-col glass-panel flex flex-col relative">
            
            <div id="welcomeMsg" class="absolute inset-0 flex flex-col items-center justify-center text-slate-400">
                <i class="fab fa-windows text-6xl mb-4 opacity-20"></i>
                <p>×‘×—×¨ × ×•×©× ×›×“×™ ×œ×”×ª×—×™×œ ×œ×¢×¨×•×š</p>
            </div>

            <div id="editorPanel" class="hidden flex-1 overflow-y-auto p-6">
                
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-xs font-bold text-slate-400 mb-1 uppercase">×©× ×”× ×•×©×</label>
                        <input type="text" id="editTopic" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 focus:bg-white focus:ring-2 focus:ring-blue-400 outline-none transition font-bold text-slate-700">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-400 mb-1 uppercase">××™×œ×•×ª ××¤×ª×—</label>
                        <input type="text" id="editKeywords" class="w-full p-3 rounded-xl border border-gray-200 bg-white/50 focus:bg-white focus:ring-2 focus:ring-blue-400 outline-none transition" placeholder="×œ××©×œ: ××™×˜×•×, × ×–×™×œ×”">
                    </div>
                </div>

                <label class="block text-xs font-bold text-slate-400 mb-2 uppercase">×¢×•×¨×š ×”×ª×©×•×‘×” ×”×—×›×</label>
                <div class="toolbar sticky top-0 z-10">
                    <div class="relative group">
                        <button class="tool-btn text-blue-600 border-blue-100 bg-blue-50">
                            <i class="fas fa-search"></i> ×©×œ×•×£ ××•×¦×¨
                        </button>
                        <div class="product-search-results group-hover:block hover:block">
                            <input type="text" placeholder="×”×§×œ×“ ×©× ××•×¦×¨..." class="w-full p-2 text-xs border-b outline-none" oninput="searchProduct(this.value)">
                            <div id="productResultsList"></div>
                        </div>
                    </div>

                    <button class="tool-btn" onclick="insertEmoji('ğŸ‘‹')"><i class="far fa-smile text-yellow-500"></i></button>
                    <button class="tool-btn" onclick="insertTagStaff()"><i class="fas fa-headset text-purple-500"></i> ×ª×™×™×’ × ×¦×™×’</button>
                    <button class="tool-btn" onclick="addVideo()"><i class="fab fa-youtube text-red-500"></i> ×•×™×“××•</button>
                    <button class="tool-btn" onclick="addButton()"><i class="fas fa-mouse-pointer text-gray-500"></i> ×›×¤×ª×•×¨</button>
                </div>

                <textarea id="editAnswer" class="w-full h-48 p-4 rounded-xl border border-gray-200 bg-white focus:ring-2 focus:ring-blue-400 outline-none resize-none leading-relaxed text-slate-700 shadow-inner mb-4" placeholder="×©×œ×•×, ×›××Ÿ ×¦'××˜ ×¡×‘×Ÿ..."></textarea>

                <div class="bg-slate-50 p-4 rounded-xl border border-dashed border-slate-300">
                    <label class="block text-xs font-bold text-slate-400 mb-2">××œ×× ×˜×™× ××¦×•×¨×¤×™× (×›×¤×ª×•×¨×™×/×•×™×“××•)</label>
                    <textarea id="editButtons" class="w-full h-20 bg-transparent text-xs font-mono text-slate-600 outline-none" placeholder="[]"></textarea>
                </div>
                
                <div class="mt-6 flex justify-end">
                    <button onclick="deleteTopic()" class="text-red-400 text-sm hover:underline">××—×§ × ×•×©× ×–×”</button>
                </div>
            </div>
        </div>

        <div id="col-sim" class="panel-col flex items-center justify-center bg-slate-100/50">
            <div class="phone-mockup">
                <div class="bg-white p-3 border-b flex justify-between items-center shadow-sm z-10">
                    <div class="flex items-center gap-2">
                        <div class="w-8 h-8 rounded-full bg-indigo-600 flex items-center justify-center text-white text-xs">ğŸ¤–</div>
                        <div class="text-sm font-bold text-slate-700">×¦'××˜-×¡×‘×Ÿ</div>
                    </div>
                    <div class="text-[10px] text-green-500 font-bold flex items-center gap-1"><div class="w-2 h-2 rounded-full bg-green-500"></div> Online</div>
                </div>
                
                <div class="sim-screen custom-scroll" id="simScreen">
                    <div class="bubble bubble-bot">×”×™×™! ×‘×“×•×§ ××•×ª×™ ×›××Ÿ ×‘×–××Ÿ ×××ª. ğŸ‘‡</div>
                </div>
                
                <div class="typing ml-4" id="typingInd">
                    <div class="dot"></div><div class="dot"></div><div class="dot"></div>
                </div>

                <div class="p-3 bg-white border-t flex gap-2">
                    <input type="text" id="simInput" class="flex-1 bg-slate-100 rounded-full px-4 py-2 text-sm outline-none" placeholder="×”×§×œ×“..." onkeydown="if(event.key==='Enter') testBot()">
                    <button onclick="testBot()" class="text-blue-600 p-2"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>

    </div>

    <script>
        // --- Mock Database (××•×¦×¨×™× ×œ×“×•×’××” ××”××¢×¨×›×ª) ---
        const productsDB = [
            { id: 101, name: "×¡×™×§×” 107 (25 ×§\"×’)", image: "https://via.placeholder.com/40" },
            { id: 102, name: "×¡×™×§×” 603 ××™×˜×•×", image: "https://via.placeholder.com/40" },
            { id: 103, name: "××œ×˜ × ×©×¨ ×©×—×•×¨", image: "https://via.placeholder.com/40" },
            { id: 104, name: "×˜×™×˜ ××•×›×Ÿ", image: "https://via.placeholder.com/40" },
            { id: 105, name: "×‘×œ×•×§ 10 ×¤×•××™×¡", image: "https://via.placeholder.com/40" },
        ];

        let brainData = [
            { id: 1, topic: "×¤×ª×™×—", keywords: ["×”×™×™", "×©×œ×•×"], answer: "××”×œ×Ÿ! ×× ×™ ×¦'××˜ ×¡×‘×Ÿ. ××™×š ××¤×©×¨ ×œ×¢×–×•×¨ ×”×™×•×? ğŸ‘‹", buttons: [] },
        ];
        let activeId = null;

        // --- Mobile Tabs Logic ---
        function setTab(tab) {
            document.querySelectorAll('.panel-col').forEach(el => el.classList.remove('active'));
            document.getElementById(`col-${tab}`).classList.add('active');
            
            // Visual feedback
            document.querySelectorAll('.mobile-nav button').forEach(b => b.classList.remove('bg-slate-100', 'text-blue-600'));
            document.getElementById(`btn-${tab}`).classList.add('bg-slate-100', 'text-blue-600');
        }

        // --- App Logic ---
        window.onload = () => {
            renderList();
            // Default active on desktop
            if(window.innerWidth > 1024) loadTopic(1);
            else setTab('list');
        };

        function renderList() {
            const container = document.getElementById('topicsContainer');
            container.innerHTML = brainData.map(item => `
                <div onclick="loadTopic(${item.id})" class="brain-item ${activeId === item.id ? 'active' : ''}">
                    <div class="font-bold text-sm text-slate-700">${item.topic}</div>
                    <div class="text-xs text-slate-400 truncate">${item.keywords.join(', ') || '×œ×œ× ××™×œ×™×'}</div>
                </div>
            `).join('');
        }

        window.loadTopic = (id) => {
            activeId = id;
            const data = brainData.find(i => i.id === id);
            
            document.getElementById('welcomeMsg').classList.add('hidden');
            document.getElementById('editorPanel').classList.remove('hidden');
            
            document.getElementById('editTopic').value = data.topic;
            document.getElementById('editKeywords').value = data.keywords.join(', ');
            document.getElementById('editAnswer').value = data.answer;
            document.getElementById('editButtons').value = JSON.stringify(data.buttons || [], null, 2);
            
            renderList();
            if(window.innerWidth <= 1024) setTab('editor');
            
            // Auto preview
            document.getElementById('simScreen').innerHTML = ''; // Clear
            showBotMsg(data.answer, data.buttons);
        };

        // --- Smart Editor Tools ---
        
        // 1. Product Search Mechanism
        window.searchProduct = (query) => {
            const list = document.getElementById('productResultsList');
            if(!query) { list.innerHTML=''; return; }
            
            const results = productsDB.filter(p => p.name.includes(query));
            list.innerHTML = results.map(p => `
                <div class="search-item" onclick="insertProduct(${p.id})">
                    <img src="${p.image}" class="w-8 h-8 rounded">
                    <div class="text-xs font-bold">${p.name}</div>
                </div>
            `).join('');
        };

        window.insertProduct = (pid) => {
            const p = productsDB.find(x => x.id === pid);
            const txt = document.getElementById('editAnswer');
            txt.value += `\nğŸ“¦ ×”× ×” ×”××•×¦×¨ ×©×‘×™×§×©×ª: ${p.name}`;
            
            // Add automated button
            const btns = JSON.parse(document.getElementById('editButtons').value || '[]');
            btns.push({ label: `×”×•×¡×£ ${p.name} ×œ×¢×’×œ×”`, payload: `ADD_${pid}` });
            document.getElementById('editButtons').value = JSON.stringify(btns, null, 2);
            
            document.getElementById('productResultsList').innerHTML = ''; // close list
        };

        window.insertEmoji = (char) => document.getElementById('editAnswer').value += char;
        window.insertTagStaff = () => document.getElementById('editAnswer').value += "\n(×”×•×“×¢×” ×–×• ×ª×•×¢×‘×¨ ×’× ×œ×”×¨××œ/×¨××™ ×œ×‘×“×™×§×” ğŸ‘¨â€ğŸ’»)";

        // --- Simulator Logic ---
        window.testBot = () => {
            const inp = document.getElementById('simInput');
            const txt = inp.value;
            if(!txt) return;

            // User Msg
            const screen = document.getElementById('simScreen');
            screen.innerHTML += `<div class="bubble bubble-user">${txt}</div>`;
            inp.value = '';
            screen.scrollTop = screen.scrollHeight;

            // Typing Effect
            const typing = document.getElementById('typingInd');
            typing.style.display = 'flex';
            screen.scrollTop = screen.scrollHeight;

            // Simulate Network Delay
            setTimeout(() => {
                typing.style.display = 'none';
                
                // Check Keywords match
                const keywords = document.getElementById('editKeywords').value.split(',').map(s=>s.trim());
                const isMatch = keywords.some(k => txt.includes(k));
                
                if (isMatch) {
                    const ans = document.getElementById('editAnswer').value;
                    const btns = JSON.parse(document.getElementById('editButtons').value || '[]');
                    showBotMsg(ans, btns);
                } else {
                    showBotMsg("ğŸ¤” ×œ× ×”×‘× ×ª×™... × ×¡×” ××™×œ×” ××”×¨×©×™××” ×©×”×’×“×¨×ª.");
                }
            }, 1000);
        };

        function showBotMsg(text, buttons = []) {
            const screen = document.getElementById('simScreen');
            // Convert line breaks to HTML
            const htmlText = text.replace(/\n/g, '<br>');
            
            screen.innerHTML += `<div class="bubble bubble-bot">${htmlText}</div>`;
            
            if(buttons.length > 0) {
                buttons.forEach(b => {
                    screen.innerHTML += `<button class="w-full mt-1 bg-blue-50 text-blue-600 py-2 rounded-lg text-xs font-bold border border-blue-100 hover:bg-blue-100 transition">${b.label}</button>`;
                });
            }
            screen.scrollTop = screen.scrollHeight;
        }

        // --- System ---
        window.createNewTopic = () => {
            const newId = Date.now();
            brainData.push({ id: newId, topic: "× ×•×©× ×—×“×©", keywords: [], answer: "", buttons: [] });
            loadTopic(newId);
        };

        window.saveChanges = () => {
            if(!activeId) return;
            const item = brainData.find(i => i.id === activeId);
            item.topic = document.getElementById('editTopic').value;
            item.keywords = document.getElementById('editKeywords').value.split(',');
            item.answer = document.getElementById('editAnswer').value;
            
            const btn = document.querySelector('header button');
            btn.innerHTML = '<i class="fas fa-check"></i> × ×©××¨!';
            btn.classList.add('bg-green-600');
            setTimeout(() => {
                btn.innerHTML = '<i class="fas fa-save"></i> ×©××•×¨ ×©×™× ×•×™×™×';
                btn.classList.remove('bg-green-600');
            }, 1500);
            
            renderList();
        };
    </script>
</body>
</html>
